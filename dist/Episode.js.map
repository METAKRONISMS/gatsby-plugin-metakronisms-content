{"version":3,"sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/webpack/bootstrap","webpack://[name]/external \"react\"","webpack://[name]/external \"react-jss\"","webpack://[name]/external \"core-js/modules/es.symbol\"","webpack://[name]/external \"core-js/modules/es.array.filter\"","webpack://[name]/external \"core-js/modules/es.array.join\"","webpack://[name]/external \"core-js/modules/es.symbol.description\"","webpack://[name]/external \"core-js/modules/es.symbol.iterator\"","webpack://[name]/external \"core-js/modules/es.array.from\"","webpack://[name]/external \"core-js/modules/es.array.iterator\"","webpack://[name]/external \"core-js/modules/es.array.slice\"","webpack://[name]/external \"core-js/modules/es.function.name\"","webpack://[name]/external \"core-js/modules/es.object.to-string\"","webpack://[name]/external \"core-js/modules/es.regexp.to-string\"","webpack://[name]/external \"core-js/modules/es.string.iterator\"","webpack://[name]/external \"core-js/modules/web.dom-collections.iterator\"","webpack://[name]/external \"core-js/modules/es.array.for-each\"","webpack://[name]/external \"core-js/modules/es.object.keys\"","webpack://[name]/external \"core-js/modules/web.dom-collections.for-each\"","webpack://[name]/external \"core-js/modules/es.object.get-own-property-descriptor\"","webpack://[name]/external \"core-js/modules/es.object.get-own-property-descriptors\"","webpack://[name]/./src/components/Card/Card.jsx","webpack://[name]/./src/components/Episode/Context.jsx","webpack://[name]/external \"d3\"","webpack://[name]/./src/components/Layout/Layout.jsx","webpack://[name]/./src/components/Button/Button.jsx","webpack://[name]/external \"core-js/modules/es.array.index-of\"","webpack://[name]/external \"core-js/modules/web.timers\"","webpack://[name]/external \"core-js/modules/es.array.concat\"","webpack://[name]/external \"prop-types\"","webpack://[name]/external \"core-js/modules/es.array.map\"","webpack://[name]/external \"gatsby-plugin-mdx\"","webpack://[name]/external \"core-js/modules/es.array.reduce\"","webpack://[name]/external \"core-js/modules/es.array.includes\"","webpack://[name]/external \"core-js/modules/es.object.get-prototype-of\"","webpack://[name]/external \"core-js/modules/es.object.set-prototype-of\"","webpack://[name]/external \"core-js/modules/es.object.values\"","webpack://[name]/external \"core-js/modules/es.reflect.construct\"","webpack://[name]/external \"core-js/modules/es.string.includes\"","webpack://[name]/./src/components/Episode/History.jsx","webpack://[name]/./src/components/Episode/Graph.jsx","webpack://[name]/./src/components/Episode/Choices.jsx","webpack://[name]/./src/hooks/useApp.js","webpack://[name]/./src/components/Episode/Episode.jsx","webpack://[name]/./src/components/Episode/useEpisode.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","useStyles","createUseStyles","theme","margin","inner","border","padding","Card","children","className","hide","appear","React","useState","show","setShow","useTheme","classes","useEffect","rootAppear","rootShow","filter","Boolean","join","defaultProps","defaultEpisode","steps","episodeSteps","getStepInfo","makeStep","setStepProgress","EpisodeContext","createContext","withEpisode","Comp","props","Consumer","ctx","Layout","visible","setVisible","handleMouseMove","timer","setTimeout","window","addEventListener","passive","clearTimeout","removeEventListener","data-visible","Button","rest","type","History","map","stepId","step","title","minWidth","minHeight","maxWidth","maxHeight","GraphBase","el","onItemMouseEnter","onItemMouseOut","onItemClick","data","links","nodes","width","clientWidth","height","clientHeight","simulation","d3","force","id","svg","attr","link","append","selectAll","Math","sqrt","node","color","on","info","els","dataNode","index","drag","text","source","x","y","target","full","allSteps","keys","forEach","group","prevId","linkKey","length","choices","includes","end","values","active","alphaTarget","restart","fx","fy","textContent","appendChild","chart","renderChart","prevSteps","prevFull","newSteps","newFull","ref","refEl","Component","Graph","Connected","propTypes","PropTypes","func","Choices","progress","handleChoice","choice","onClick","button","defaultState","reducer","state","action","seasonNr","payload","episodeNr","audioMuted","audioVolume","Error","useApp","initialState","proxyReducer","fn","args","returned","console","useReducer","dispatch","proxyDispatch","setSeason","nr","setEpisode","toggleAudio","setAudioVolume","val","Episode","pageContext","assets","mdx","episodeMdx","reduce","obj","parent","frontmatter","body","mdxObject","appStuff","episodeContext","episode","setSteps","wanted","curr","useEpisode","asset","base","publicURL","currentStep","Provider","main","mdxWrapper","episodeInfo","episodeInfoCard"],"mappings":"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","file":"Episode.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Episode\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Episode\"] = factory();\n\telse\n\t\troot[\"Episode\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 36);\n","module.exports = require(\"react\");","module.exports = require(\"react-jss\");","module.exports = require(\"core-js/modules/es.symbol\");","module.exports = require(\"core-js/modules/es.array.filter\");","module.exports = require(\"core-js/modules/es.array.join\");","module.exports = require(\"core-js/modules/es.symbol.description\");","module.exports = require(\"core-js/modules/es.symbol.iterator\");","module.exports = require(\"core-js/modules/es.array.from\");","module.exports = require(\"core-js/modules/es.array.iterator\");","module.exports = require(\"core-js/modules/es.array.slice\");","module.exports = require(\"core-js/modules/es.function.name\");","module.exports = require(\"core-js/modules/es.object.to-string\");","module.exports = require(\"core-js/modules/es.regexp.to-string\");","module.exports = require(\"core-js/modules/es.string.iterator\");","module.exports = require(\"core-js/modules/web.dom-collections.iterator\");","module.exports = require(\"core-js/modules/es.array.for-each\");","module.exports = require(\"core-js/modules/es.object.keys\");","module.exports = require(\"core-js/modules/web.dom-collections.for-each\");","module.exports = require(\"core-js/modules/es.object.get-own-property-descriptor\");","module.exports = require(\"core-js/modules/es.object.get-own-property-descriptors\");","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { createUseStyles, useTheme } from 'react-jss';\n\n// eslint-disable-next-line\nconst useStyles = createUseStyles((theme) => ({\n  root: {\n    margin: 10,\n  },\n  inner: {\n    border: '1px solid currentColor',\n    padding: 9,\n  },\n}));\n\nconst Card = ({\n  children,\n  className,\n  hide,\n  appear,\n}) => {\n  const [show, setShow] = React.useState(!appear);\n  const theme = useTheme();\n  const classes = useStyles({ theme });\n\n  React.useEffect(() => {\n    if (appear && !show) setShow(true);\n  }, [appear, show]);\n\n  return (\n    <div\n      className={[\n        className,\n        classes.root,\n        hide && classes.hide,\n        appear && classes.rootAppear,\n        appear && show && classes.rootShow,\n      ].filter(Boolean).join(' ')}\n    >\n      <div className={classes.inner}>\n        {children}\n      </div>\n    </div>\n  );\n};\n\nCard.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.node,\n  appear: PropTypes.bool,\n  hide: PropTypes.bool,\n};\n\nCard.defaultProps = {\n  className: null,\n  children: null,\n  appear: null,\n  hide: false,\n};\n\nexport default Card;\n","import React from 'react';\n\nexport const defaultEpisode = {\n  steps: [],\n  episodeSteps: {},\n  getStepInfo: () => { },\n  makeStep: () => { },\n  setStepProgress: () => { },\n};\n\nconst EpisodeContext = React.createContext(defaultEpisode);\n\nexport default EpisodeContext;\n\nexport const withEpisode = (Comp) => {\n  const returned = (props) => (\n    <EpisodeContext.Consumer>\n      {\n        (ctx) => (\n          // eslint-disable-next-line react/jsx-props-no-spreading\n          <Comp {...{ ...props, ...ctx }} />\n        )\n      }\n    </EpisodeContext.Consumer>\n  );\n\n  return returned;\n};\n","module.exports = require(\"d3\");","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst Layout = ({ children }) => {\n  const [visible, setVisible] = React.useState(1);\n  const handleMouseMove = () => !visible && setVisible(true);\n  React.useEffect(() => {\n    const timer = setTimeout(() => setVisible(false), 1500);\n    window.addEventListener('mousemove', handleMouseMove, { passive: true });\n    return () => {\n      clearTimeout(timer);\n      window.removeEventListener('mousemove', handleMouseMove, { passive: true });\n    };\n  });\n\n  return (\n    <div data-visible={visible}>\n      {children}\n    </div>\n  );\n};\n\nLayout.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nexport default Layout;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport { createUseStyles, useTheme } from 'react-jss';\n\n// eslint-disable-next-line\nconst useStyles = createUseStyles((theme) => ({}));\n\nconst Button = ({\n  children,\n  className,\n  hide,\n  ...rest\n}) => {\n  const theme = useTheme();\n  const classes = useStyles({ ...rest, theme });\n  return (\n    <button\n      type=\"button\"\n      // eslint-disable-next-line react/jsx-props-no-spreading\n      {...rest}\n      className={[\n        classes.root,\n        className,\n        hide && classes.hide,\n      ].filter(Boolean).join(' ')}\n    >\n      {children}\n    </button>\n  );\n};\n\nButton.propTypes = {\n  children: PropTypes.node,\n  className: PropTypes.string,\n  hide: PropTypes.bool,\n};\n\nButton.defaultProps = {\n  children: null,\n  className: null,\n  hide: false,\n};\n\nexport default Button;\n","module.exports = require(\"core-js/modules/es.array.index-of\");","module.exports = require(\"core-js/modules/web.timers\");","module.exports = require(\"core-js/modules/es.array.concat\");","module.exports = require(\"prop-types\");","module.exports = require(\"core-js/modules/es.array.map\");","module.exports = require(\"gatsby-plugin-mdx\");","module.exports = require(\"core-js/modules/es.array.reduce\");","module.exports = require(\"core-js/modules/es.array.includes\");","module.exports = require(\"core-js/modules/es.object.get-prototype-of\");","module.exports = require(\"core-js/modules/es.object.set-prototype-of\");","module.exports = require(\"core-js/modules/es.object.values\");","module.exports = require(\"core-js/modules/es.reflect.construct\");","module.exports = require(\"core-js/modules/es.string.includes\");","import React from 'react';\nimport { createUseStyles, useTheme } from 'react-jss';\nimport { withEpisode } from './Context';\n\n// eslint-disable-next-line\nconst useStyles = createUseStyles((theme) => ({}));\n\nconst History = withEpisode(({\n  getStepInfo,\n  steps,\n}) => {\n  const theme = useTheme();\n  const classes = useStyles({ theme });\n  return (\n    <div className={classes.root}>\n      <div>Episode history:</div>\n\n      {steps.map((stepId) => {\n        const step = getStepInfo(stepId);\n\n        return (step && (\n        <div key={stepId}>{step.title}</div>\n        )) || null;\n      })}\n    </div>\n  );\n});\n\nexport default History;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport * as d3 from 'd3';\n\nimport { createUseStyles, useTheme } from 'react-jss';\nimport { withEpisode } from './Context';\n\n// eslint-disable-next-line\nconst useStyles = createUseStyles((theme) => ({\n  root: {\n    minWidth: 100,\n    minHeight: 100,\n    maxWidth: 400,\n    maxHeight: 400,\n  },\n}));\n\nclass GraphBase extends React.Component {\n  componentDidMount() {\n    this.renderChart();\n  }\n\n  componentDidUpdate({ steps: prevSteps, full: prevFull }) {\n    const { steps: newSteps, full: newFull } = this.props;\n    if (prevSteps.join('') !== newSteps.join('') || prevFull !== newFull) {\n      this.renderChart();\n    }\n  }\n\n  chart = (el = this.el) => {\n    const {\n      getStepInfo,\n      onItemMouseEnter,\n      onItemMouseOut,\n      onItemClick,\n    } = this.props;\n    const data = this.data();\n    const links = data.links.map((d) => Object.create(d));\n    const nodes = data.nodes.map((d) => Object.create(d));\n    const {\n      clientWidth: width,\n      clientHeight: height,\n    } = el;\n\n    const simulation = d3.forceSimulation(nodes)\n      .force('link', d3.forceLink(links).id((d) => d.id))\n      .force('charge', d3.forceManyBody())\n      .force('center', d3.forceCenter(width / 2, height / 2));\n\n    const svg = d3.create('svg')\n      .attr('viewBox', [0, 0, width, width]);\n\n    const link = svg.append('g')\n      .attr('stroke', '#999')\n      .attr('stroke-opacity', 0.6)\n      .selectAll('line')\n      .data(links)\n      .join('line')\n      .attr('stroke-width', (d) => Math.sqrt(d.value));\n\n    const node = svg.append('g')\n      .attr('stroke', '#fff')\n      .attr('stroke-width', 1.5)\n      .selectAll('circle')\n      .data(nodes)\n      .join('circle')\n      .attr('r', 5)\n      .attr('fill', this.color())\n      .on('mouseenter', (info, els) => {\n        const dataNode = data.nodes[info.index];\n        if (onItemMouseEnter) {\n          onItemMouseEnter(getStepInfo(dataNode.id), dataNode, info, els);\n        }\n      })\n      .on('mouseout', (info, els) => {\n        const dataNode = data.nodes[info.index];\n        if (onItemMouseOut) {\n          onItemMouseOut(getStepInfo(dataNode.id), dataNode, info, els);\n        }\n      })\n      .on('click', (info, els) => {\n        const dataNode = data.nodes[info.index];\n        if (onItemClick) {\n          onItemClick(getStepInfo(dataNode.id), dataNode, info, els);\n        }\n      })\n      .call(this.drag(simulation));\n\n    node.append('title')\n      .text((d) => d.id);\n\n    simulation.on('tick', () => {\n      link\n        .attr('x1', (d) => d.source.x)\n        .attr('y1', (d) => d.source.y)\n        .attr('x2', (d) => d.target.x)\n        .attr('y2', (d) => d.target.y);\n\n      node\n        .attr('cx', (d) => d.x)\n        .attr('cy', (d) => d.y);\n    });\n\n    return svg.node();\n  };\n\n  data = () => {\n    const {\n      steps,\n      episodeSteps,\n      getStepInfo,\n      full,\n    } = this.props;\n    const data = {};\n    const nodes = {};\n    const links = {};\n\n    const allSteps = full ? Object.keys(episodeSteps) : ['intro', ...steps];\n    allSteps.forEach((id, i) => {\n      const step = getStepInfo(id);\n      if (!step) return;\n\n      nodes[id] = { id, group: 2 };\n      if (!full && i) {\n        const prevId = allSteps[i - 1];\n        const linkKey = [prevId, id].join('->-');\n        links[linkKey] = { source: prevId, target: id, value: 10 };\n      }\n\n      if (\n        (!full && i >= steps.length)\n        || !step.choices\n        || !step.choices.length\n      ) return;\n\n      step.choices.forEach(({ target }) => {\n        nodes[target] = {\n          id: target,\n          group: allSteps.includes(target) ? 2 : 4,\n        };\n        const linkKey = [id, target].join('-x-');\n        links[linkKey] = links[linkKey] || { source: id, target, value: 1 };\n      });\n    });\n\n    // nodes.intro.group = 1;\n    if (nodes.end) nodes.end.group = 3;\n    data.nodes = Object.values(nodes);\n    data.links = Object.values(links);\n    return data;\n  };\n\n  // eslint-disable-next-line arrow-body-style\n  color = () => {\n    // const scale = d3.scaleOrdinal(d3.schemeCategory10);\n    // return (d) => scale(d.group);\n    return (d) => {\n      switch (d.group) {\n        case 1:\n          return 'lightgreen';\n        case 2:\n          return 'blue';\n        case 3:\n          return 'green';\n        default:\n          return 'lightgrey';\n      }\n    };\n  };\n\n  drag = (simulation) => {\n    /* eslint-disable no-param-reassign */\n    function dragstarted(d) {\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\n      d.fx = d.x;\n      d.fy = d.y;\n    }\n\n    function dragged(d) {\n      d.fx = d3.event.x;\n      d.fy = d3.event.y;\n    }\n\n    function dragended(d) {\n      if (!d3.event.active) simulation.alphaTarget(0);\n      d.fx = null;\n      d.fy = null;\n    }\n\n    return d3.drag()\n      .on('start', dragstarted)\n      .on('drag', dragged)\n      .on('end', dragended);\n    /* eslint-enable no-param-reassign */\n  }\n\n  refEl = (el) => {\n    // if (!this.el && el) el.appendChild(this.chart(el));\n    this.el = el;\n  };\n\n  renderChart = () => {\n    if (!this.el) return;\n    this.el.textContent = '';\n    this.el.appendChild(this.chart());\n  };\n\n  render() {\n    const { steps, classes } = this.props;\n    return (\n      <div\n        key={steps.join('')}\n        ref={this.refEl}\n        className={(classes || {}).root}\n      />\n    );\n  }\n}\n\nGraphBase.propTypes = {\n  classes: PropTypes.objectOf(PropTypes.string),\n  full: PropTypes.bool,\n  onItemMouseEnter: PropTypes.func,\n  onItemMouseOut: PropTypes.func,\n  onItemClick: PropTypes.func,\n  getStepInfo: PropTypes.func.isRequired,\n  steps: PropTypes.arrayOf(PropTypes.string).isRequired,\n  episodeSteps: PropTypes.objectOf(PropTypes.shape({\n    title: PropTypes.string,\n    choices: PropTypes.arrayOf(PropTypes.shape({\n      target: PropTypes.string.isRequired,\n      title: PropTypes.string.isRequired,\n    })),\n  })).isRequired,\n};\n\nGraphBase.defaultProps = {\n  classes: null,\n  full: false,\n  onItemMouseEnter: null,\n  onItemMouseOut: null,\n  onItemClick: null,\n};\n\nconst Graph = (props) => {\n  const theme = useTheme();\n  const classes = useStyles({ theme });\n  // eslint-disable-next-line react/jsx-props-no-spreading\n  return (<GraphBase {...props} classes={classes} />);\n};\n\nexport default Graph;\n\n// Graph.propTypes = {\n//   ...GraphBase.propTypes,\n// };\n// Graph.defaultProps = {\n//   ...GraphBase.defaultProps,\n// };\n\nexport const Connected = withEpisode(Graph);\n\nConnected.propTypes = {\n  onItemMouseEnter: PropTypes.func,\n  onItemMouseOut: PropTypes.func,\n  onItemClick: PropTypes.func,\n};\n\nConnected.defaultProps = {\n  onItemMouseEnter: null,\n  onItemMouseOut: null,\n  onItemClick: null,\n};\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { createUseStyles, useTheme } from 'react-jss';\nimport { withEpisode } from './Context';\nimport Button from '../Button';\nimport Card from '../Card/Card';\n\n// eslint-disable-next-line\nconst useStyles = createUseStyles((theme) => ({}));\n\nconst Choices = ({\n  getStepInfo,\n  makeStep,\n  progress,\n}) => {\n  const step = getStepInfo();\n  const handleChoice = (choice) => () => {\n    makeStep(choice.target, choice);\n  };\n  const theme = useTheme();\n  const classes = useStyles({ theme });\n  return (\n    <Card className={classes.root} hide={progress <= 1}>\n      <div\n        className={[\n          classes.inner,\n          progress <= 1 && classes.hide,\n        ].filter(Boolean).join(' ')}\n      >\n        {step && step.choices.map((choice) => (\n          <Button\n            key={choice.target}\n            onClick={handleChoice(choice)}\n            className={classes.button}\n          >\n            {choice.title}\n          </Button>\n        ))}\n      </div>\n    </Card>\n  );\n};\n\nChoices.propTypes = {\n  getStepInfo: PropTypes.func.isRequired,\n  makeStep: PropTypes.func.isRequired,\n  progress: PropTypes.number.isRequired,\n};\n\nexport default Choices;\n\nexport const Connected = withEpisode(Choices);\n","import { useReducer } from 'react';\n\nconst defaultState = {};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'SET_SEASON':\n      return {\n        ...state,\n        seasonNr: action.payload,\n      };\n    case 'SET_EPISODE':\n      return {\n        ...state,\n        episodeNr: action.payload,\n      };\n    case 'MAKE_EPISODE_STEP':\n      return {\n        ...state,\n        steps: [...(state.steps || []), action.payload],\n      };\n    case 'TOGGLE_AUDIO':\n      return {\n        ...state,\n        audioMuted: !state.audioMuted,\n      };\n    case 'SET_AUDIO_VOLUME':\n      return {\n        ...state,\n        audioVolume: action.payload,\n      };\n    default:\n      throw new Error(`Invalid action \"${action.type}\"`);\n  }\n};\n\nconst useApp = ({\n  initialState = defaultState,\n} = {}) => {\n  const proxyReducer = (fn) => (...args) => {\n    const returned = fn(...args);\n    // eslint-disable-next-line no-console\n    console.info('dispatch app reducer', args, returned);\n    return returned;\n  };\n\n  const [state, dispatch] = useReducer(proxyReducer(reducer), initialState);\n  const proxyDispatch = (...args) => {\n    const returned = dispatch(...args);\n    // eslint-disable-next-line no-console\n    console.info('dispatch app reducer', args, returned);\n    return returned;\n  };\n\n  return {\n    ...state,\n    setSeason: (nr) => proxyDispatch({ type: 'SET_SEASON', payload: nr }),\n    setEpisode: (nr) => proxyDispatch({ type: 'SET_EPISODE', payload: nr }),\n    makeStep: (id) => proxyDispatch({ type: 'MAKE_EPISODE_STEP', payload: id }),\n    toggleAudio: () => proxyDispatch({ type: 'TOGGLE_AUDIO' }),\n    setAudioVolume: (val) => proxyDispatch({ type: 'SET_AUDIO_VOLUME', payload: val }),\n  };\n};\n\nexport default useApp;\n","/* eslint-disable no-console */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { MDXRenderer } from 'gatsby-plugin-mdx';\n\nimport { createUseStyles, useTheme } from 'react-jss';\nimport Layout from '../Layout/Layout';\nimport Card from '../Card/Card';\nimport EpisodeContext from './Context';\nimport useEpisode from './useEpisode';\nimport History from './History';\nimport { Connected as Graph } from './Graph';\nimport { Connected as Choices } from './Choices';\nimport useApp from '../../hooks/useApp';\n\n// eslint-disable-next-line\nconst useStyles = createUseStyles((theme) => ({}));\n\nexport const episodePath = (s, e, p) => `/episodes/s${s}e${e}/${p || ''}`;\n\nconst mdxObject = (episodeMdx) => episodeMdx.nodes.reduce((obj, {\n  parent: { name },\n  frontmatter: { title, choices },\n  body,\n}) => ({\n  ...obj,\n  [name]: {\n    id: name,\n    title,\n    body,\n    choices: choices || [],\n  },\n}), {});\n\nconst Episode = (props) => {\n  const {\n    pageContext: {\n      title,\n      assets,\n    },\n    data: {\n      episodeMdx,\n    },\n  } = props;\n\n  /*\n  console.info(JSON.stringify({\n    // eslint-disable-next-line react/destructuring-assignment\n    pageContext: props.pageContext,\n    // eslint-disable-next-line react/destructuring-assignment\n    data: props.data,\n  }, null, 2));\n  */\n\n  const mdx = mdxObject(episodeMdx);\n  const [progress, setStepProgress] = React.useState(0);\n\n  const appStuff = useApp();\n  const episodeContext = useEpisode({\n    title,\n    assets: (assets || []).reduce((obj, asset) => ({\n      ...obj,\n      [asset.base]: asset.publicURL,\n    }), {}),\n    episodeSteps: mdx,\n    setStepProgress,\n    ...appStuff,\n  });\n  const currentStep = episodeContext.steps.length\n    ? episodeContext.steps[episodeContext.steps.length - 1]\n    : 'intro';\n  const theme = useTheme();\n  const classes = useStyles({ theme });\n\n  const { body = null } = episodeContext.getStepInfo(currentStep) || {};\n\n  return (\n    <EpisodeContext.Provider value={episodeContext}>\n      <Layout>\n        <div className={classes.root}>\n          <div className={classes.main}>\n            <div className={classes.mdxWrapper}>\n              {body\n                ? (<MDXRenderer>{body}</MDXRenderer>)\n                : 'Something is not quite right. Sorry'}\n            </div>\n\n            <div className={classes.episodeInfo}>\n              <Card className={classes.episodeInfoCard} appear>\n                <History />\n              </Card>\n\n              <Card className={classes.episodeInfoCard} appear>\n                <Graph\n                  onItemMouseEnter={(...args) => { console.info('MouseEnter', ...args); }}\n                  onItemMouseOut={(...args) => { console.info('MouseOut', ...args); }}\n                  onItemClick={(...args) => { console.info('Click', ...args); }}\n                />\n              </Card>\n            </div>\n\n            <Choices progress={progress} />\n          </div>\n        </div>\n      </Layout>\n    </EpisodeContext.Provider>\n  );\n};\n\nEpisode.propTypes = {\n  pageContext: PropTypes.shape({\n    title: PropTypes.string,\n    body: PropTypes.string,\n    assets: PropTypes.arrayOf(PropTypes.object),\n  }).isRequired,\n  data: PropTypes.shape({\n    episodeMdx: PropTypes.shape({\n      nodes: PropTypes.arrayOf(PropTypes.shape({\n        body: PropTypes.string.isRequired,\n        parent: PropTypes.shape({\n          name: PropTypes.string.isRequired,\n        }).isRequired,\n        frontmatter: PropTypes.shape({\n          title: PropTypes.string,\n        }).isRequired,\n      })).isRequired,\n    }).isRequired,\n  }).isRequired,\n};\n\nexport default Episode;\n","import React from 'react';\n\nexport default function useEpisode(episode = {}) {\n  const [steps, setSteps] = React.useState([]);\n\n  const getStepInfo = (wanted) => episode\n    .episodeSteps[wanted || steps[steps.length - 1] || 'intro'];\n\n  // eslint-disable-next-line no-unused-vars\n  const makeStep = (target, choice = {}) => {\n    // console.info('new step', target, choice, getStepInfo(target));\n    setSteps((curr) => ([...curr, target]));\n  };\n\n  return {\n    ...episode,\n    steps,\n    getStepInfo,\n    makeStep,\n  };\n}\n"],"sourceRoot":""}